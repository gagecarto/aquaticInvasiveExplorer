function mapInits(){mapboxgl.accessToken="pk.eyJ1IjoiZ2FnZWNhcnRvIiwiYSI6ImNpb2xsMXVzdDAxcHR1Nm0wOXl3dThvNWIifQ.OKsbC0HOK-OjaPKyjCUxrg",map=new mapboxgl.Map({container:"map",style:"mapbox://styles/mapbox/streets-v9",center:[-111,43],zoom:4}),map.addControl(new mapboxgl.NavigationControl),map.on("load",function(){addMapLayers()})}function uiInits(){$("input:radio[name='group1']").change(function(){"lakes"==$(this).val()?(map.setLayoutProperty("nhdShortLayer","visibility","none"),map.setLayoutProperty("nhdLongLayer","visibility","none"),map.setLayoutProperty("lakesLayer","visibility","visible")):(map.setLayoutProperty("lakesLayer","visibility","none"),map.setLayoutProperty("nhdShortLayer","visibility","visible"),map.setLayoutProperty("nhdLongLayer","visibility","visible"))}),$("#nhdSymbologyDropdown").material_select(),$("#nhdSymbologyDropdown").on("change",function(){currentRiskVector=$(this).val(),"none"==currentRiskVector?(map.setPaintProperty("nhdLongLayer","line-color","#0f7bbd"),map.setPaintProperty("nhdShortLayer","line-color","#0f7bbd"),map.setPaintProperty("lakesLayer","fill-color","#136190")):(map.setPaintProperty("nhdLongLayer","line-color",mapStyles[currentRiskVector+"_style"]),map.setPaintProperty("nhdShortLayer","line-color",mapStyles[currentRiskVector+"_style"]),map.setPaintProperty("lakesLayer","fill-color",mapStyles[currentRiskVector+"_style"])),legendBuilder(),queryViewportFeatures()}),$("#geographySelector").material_select(),$("#geographySelector").on("change",function(){currentAdminGeography=$(this).val()}),$(document).on("mousemove",function(e){$("#hoverBox").css({left:e.pageX+25,top:e.pageY-40})})}function numberFormater(e){return dawg=e,e.toFixed(2)}function popupHandler(e){if("visible"==map.getLayoutProperty("huc12Fill","visibility")&&$("#hoverBox").html(e.NAME12),"visible"==map.getLayoutProperty("nhdShortLayer","visibility")){var t="Unnamed Segment";if(e.MAX_GNIS_N&&(t=e.MAX_GNIS_N),"none"!==currentRiskVector){var r=$('#selectHolder select option[value="'+currentRiskVector+'"]').html();thisRiskValue=numberFormater(e[currentRiskVector]),thisRiskValue=Number(thisRiskValue)}var o='<a class="popupTitle">'+t+"</a><br>";r&&(o+='<a class="popupSubTitle">'+r+" "+thisRiskValue+"</a><br>"),$("#hoverBox").html(o)}if("visible"==map.getLayoutProperty("lakesLayer","visibility")){e.GNIS_NAME&&(t=e.GNIS_NAME);var o='<a class="popupTitle">'+t+"</a><br>";$("#hoverBox").html(o)}}function legendBuilder(){if("none"==currentRiskVector)return void $("#mapLegend").hide();$("#mapLegend").show(),$("#mapLegend").empty();var e=mapLayersConfig[currentRiskVector].breaks,t=mapLayersConfig[currentRiskVector].colors;$.each(e,function(r,o){if(0==r)var a=0;else var a=numberFormater(e[r-1]);if(r==e.length-1)var i=a+" - 100";else var i=a+" - "+numberFormater(e[r]);0==o[0]&&(i="0");var n=t[r],s=$("html").css("font-size"),l=Number(s.slice(0,2)),l=2*l,p="M 5 "+l/2+" Q 15 5, "+l/2+" "+l/2+" T "+l+" "+l/2;if(console.log(p),$("#mapLegend").prepend('<span class=\'legendBlockVector\'><svg width="100%" height="100%"><path d="'+p+'" stroke="'+n+'" fill="transparent" stroke-width="2.5"/></svg></span><label class=\'legendLabelVector\'>'+i+"</label><br>"),r==e.length-1){$('#selectHolder select option[value="'+currentRiskVector+'"]').html()}})}var mapLayers={},currentRiskVector="none",currentAdminGeography="gya";$(document).ready(function(){mapInits(),uiInits(),chartInit()});